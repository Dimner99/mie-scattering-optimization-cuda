term_tm = (Sqrt[I*epsim + epsre]*BesselJ[-1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*BesselJ[n, (2*Pi*r)/lam] - BesselJ[-1 + n, (2*Pi*r)/lam]*BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam])/(BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*HankelH2[-1 + n, (2*Pi*r)/lam] - Sqrt[I*epsim + epsre]*BesselJ[-1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*HankelH2[n, (2*Pi*r)/lam]);
term_te = (BesselJ[-1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*BesselJ[n, (2*Pi*r)/lam] - Sqrt[I*epsim + epsre]*BesselJ[-1 + n, (2*Pi*r)/lam]*BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam] + ((-(1/Sqrt[I*epsim + epsre]) + Sqrt[I*epsim + epsre])*lam*n*BesselJ[n, (2*Pi*r)/lam]*BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam])/(2*Pi*r))/(Sqrt[I*epsim + epsre]*BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*HankelH2[-1 + n, (2*Pi*r)/lam] - BesselJ[-1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*HankelH2[n, (2*Pi*r)/lam] - ((-(1/Sqrt[I*epsim + epsre]) + Sqrt[I*epsim + epsre])*lam*n*BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*HankelH2[n, (2*Pi*r)/lam])/(2*Pi*r));
dq_tm_deps_re_n = ((1 + 2*conjc[(Sqrt[I*epsim + epsre]*BesselJ[-1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*BesselJ[n, (2*Pi*r)/lam] - BesselJ[-1 + n, (2*Pi*r)/lam]*BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam])/(BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*HankelH2[-1 + n, (2*Pi*r)/lam] - Sqrt[I*epsim + epsre]*BesselJ[-1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*HankelH2[n, (2*Pi*r)/lam])])*(((BesselJ[-1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*BesselJ[n, (2*Pi*r)/lam])/(2*Sqrt[I*epsim + epsre]) + (Pi*r*BesselJ[n, (2*Pi*r)/lam]*(BesselJ[-2 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam] - BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]))/(2*lam) - (Pi*r*BesselJ[-1 + n, (2*Pi*r)/lam]*(BesselJ[-1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam] - BesselJ[1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]))/(2*Sqrt[I*epsim + epsre]*lam))*(BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*HankelH2[-1 + n, (2*Pi*r)/lam] - Sqrt[I*epsim + epsre]*BesselJ[-1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*HankelH2[n, (2*Pi*r)/lam]) - (Sqrt[I*epsim + epsre]*BesselJ[-1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*BesselJ[n, (2*Pi*r)/lam] - BesselJ[-1 + n, (2*Pi*r)/lam]*BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam])*((Pi*r*(BesselJ[-1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam] - BesselJ[1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam])*HankelH2[-1 + n, (2*Pi*r)/lam])/(2*Sqrt[I*epsim + epsre]*lam) - (BesselJ[-1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*HankelH2[n, (2*Pi*r)/lam])/(2*Sqrt[I*epsim + epsre]) - (Pi*r*(BesselJ[-2 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam] - BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam])*HankelH2[n, (2*Pi*r)/lam])/(2*lam))))/(BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*HankelH2[-1 + n, (2*Pi*r)/lam] - Sqrt[I*epsim + epsre]*BesselJ[-1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*HankelH2[n, (2*Pi*r)/lam])^2;
dq_tm_deps_im_n = ((1 + 2*conjc[(Sqrt[I*epsim + epsre]*BesselJ[-1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*BesselJ[n, (2*Pi*r)/lam] - BesselJ[-1 + n, (2*Pi*r)/lam]*BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam])/(BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*HankelH2[-1 + n, (2*Pi*r)/lam] - Sqrt[I*epsim + epsre]*BesselJ[-1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*HankelH2[n, (2*Pi*r)/lam])])*((((I/2)*BesselJ[-1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*BesselJ[n, (2*Pi*r)/lam])/Sqrt[I*epsim + epsre] + ((I/2)*Pi*r*BesselJ[n, (2*Pi*r)/lam]*(BesselJ[-2 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam] - BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]))/lam - ((I/2)*Pi*r*BesselJ[-1 + n, (2*Pi*r)/lam]*(BesselJ[-1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam] - BesselJ[1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]))/(Sqrt[I*epsim + epsre]*lam))*(BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*HankelH2[-1 + n, (2*Pi*r)/lam] - Sqrt[I*epsim + epsre]*BesselJ[-1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*HankelH2[n, (2*Pi*r)/lam]) - (Sqrt[I*epsim + epsre]*BesselJ[-1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*BesselJ[n, (2*Pi*r)/lam] - BesselJ[-1 + n, (2*Pi*r)/lam]*BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam])*(((I/2)*Pi*r*(BesselJ[-1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam] - BesselJ[1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam])*HankelH2[-1 + n, (2*Pi*r)/lam])/(Sqrt[I*epsim + epsre]*lam) - ((I/2)*BesselJ[-1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*HankelH2[n, (2*Pi*r)/lam])/Sqrt[I*epsim + epsre] - ((I/2)*Pi*r*(BesselJ[-2 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam] - BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam])*HankelH2[n, (2*Pi*r)/lam])/lam)))/(BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*HankelH2[-1 + n, (2*Pi*r)/lam] - Sqrt[I*epsim + epsre]*BesselJ[-1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*HankelH2[n, (2*Pi*r)/lam])^2;
dq_tm_dr_n = ((1 + 2*conjc[(Sqrt[I*epsim + epsre]*BesselJ[-1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*BesselJ[n, (2*Pi*r)/lam] - BesselJ[-1 + n, (2*Pi*r)/lam]*BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam])/(BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*HankelH2[-1 + n, (2*Pi*r)/lam] - Sqrt[I*epsim + epsre]*BesselJ[-1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*HankelH2[n, (2*Pi*r)/lam])])*((((I*epsim + epsre)*Pi*BesselJ[n, (2*Pi*r)/lam]*(BesselJ[-2 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam] - BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]))/lam - (Pi*(BesselJ[-2 + n, (2*Pi*r)/lam] - BesselJ[n, (2*Pi*r)/lam])*BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam])/lam + (Sqrt[I*epsim + epsre]*Pi*BesselJ[-1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*(BesselJ[-1 + n, (2*Pi*r)/lam] - BesselJ[1 + n, (2*Pi*r)/lam]))/lam - (Sqrt[I*epsim + epsre]*Pi*BesselJ[-1 + n, (2*Pi*r)/lam]*(BesselJ[-1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam] - BesselJ[1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]))/lam)*(BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*HankelH2[-1 + n, (2*Pi*r)/lam] - Sqrt[I*epsim + epsre]*BesselJ[-1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*HankelH2[n, (2*Pi*r)/lam]) - (Sqrt[I*epsim + epsre]*BesselJ[-1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*BesselJ[n, (2*Pi*r)/lam] - BesselJ[-1 + n, (2*Pi*r)/lam]*BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam])*((Sqrt[I*epsim + epsre]*Pi*(BesselJ[-1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam] - BesselJ[1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam])*HankelH2[-1 + n, (2*Pi*r)/lam])/lam + (Pi*BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*(HankelH2[-2 + n, (2*Pi*r)/lam] - HankelH2[n, (2*Pi*r)/lam]))/lam - ((I*epsim + epsre)*Pi*(BesselJ[-2 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam] - BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam])*HankelH2[n, (2*Pi*r)/lam])/lam - (Sqrt[I*epsim + epsre]*Pi*BesselJ[-1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*(HankelH2[-1 + n, (2*Pi*r)/lam] - HankelH2[1 + n, (2*Pi*r)/lam]))/lam)))/(BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*HankelH2[-1 + n, (2*Pi*r)/lam] - Sqrt[I*epsim + epsre]*BesselJ[-1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*HankelH2[n, (2*Pi*r)/lam])^2;
dq_te_deps_re_n = ((1 + 2*conjc[(BesselJ[-1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*BesselJ[n, (2*Pi*r)/lam] - Sqrt[I*epsim + epsre]*BesselJ[-1 + n, (2*Pi*r)/lam]*BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam] + ((-(1/Sqrt[I*epsim + epsre]) + Sqrt[I*epsim + epsre])*lam*n*BesselJ[n, (2*Pi*r)/lam]*BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam])/(2*Pi*r))/(Sqrt[I*epsim + epsre]*BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*HankelH2[-1 + n, (2*Pi*r)/lam] - BesselJ[-1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*HankelH2[n, (2*Pi*r)/lam] - ((-(1/Sqrt[I*epsim + epsre]) + Sqrt[I*epsim + epsre])*lam*n*BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*HankelH2[n, (2*Pi*r)/lam])/(2*Pi*r))])*(((Pi*r*BesselJ[n, (2*Pi*r)/lam]*(BesselJ[-2 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam] - BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]))/(2*Sqrt[I*epsim + epsre]*lam) - (BesselJ[-1 + n, (2*Pi*r)/lam]*BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam])/(2*Sqrt[I*epsim + epsre]) + ((1/(2*(I*epsim + epsre)^(3/2)) + 1/(2*Sqrt[I*epsim + epsre]))*lam*n*BesselJ[n, (2*Pi*r)/lam]*BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam])/(2*Pi*r) - (Pi*r*BesselJ[-1 + n, (2*Pi*r)/lam]*(BesselJ[-1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam] - BesselJ[1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]))/(2*lam) + ((-(1/Sqrt[I*epsim + epsre]) + Sqrt[I*epsim + epsre])*n*BesselJ[n, (2*Pi*r)/lam]*(BesselJ[-1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam] - BesselJ[1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]))/(4*Sqrt[I*epsim + epsre]))*(Sqrt[I*epsim + epsre]*BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*HankelH2[-1 + n, (2*Pi*r)/lam] - BesselJ[-1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*HankelH2[n, (2*Pi*r)/lam] - ((-(1/Sqrt[I*epsim + epsre]) + Sqrt[I*epsim + epsre])*lam*n*BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*HankelH2[n, (2*Pi*r)/lam])/(2*Pi*r)) - (BesselJ[-1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*BesselJ[n, (2*Pi*r)/lam] - Sqrt[I*epsim + epsre]*BesselJ[-1 + n, (2*Pi*r)/lam]*BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam] + ((-(1/Sqrt[I*epsim + epsre]) + Sqrt[I*epsim + epsre])*lam*n*BesselJ[n, (2*Pi*r)/lam]*BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam])/(2*Pi*r))*((BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*HankelH2[-1 + n, (2*Pi*r)/lam])/(2*Sqrt[I*epsim + epsre]) + (Pi*r*(BesselJ[-1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam] - BesselJ[1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam])*HankelH2[-1 + n, (2*Pi*r)/lam])/(2*lam) - (Pi*r*(BesselJ[-2 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam] - BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam])*HankelH2[n, (2*Pi*r)/lam])/(2*Sqrt[I*epsim + epsre]*lam) - ((1/(2*(I*epsim + epsre)^(3/2)) + 1/(2*Sqrt[I*epsim + epsre]))*lam*n*BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*HankelH2[n, (2*Pi*r)/lam])/(2*Pi*r) - ((-(1/Sqrt[I*epsim + epsre]) + Sqrt[I*epsim + epsre])*n*(BesselJ[-1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam] - BesselJ[1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam])*HankelH2[n, (2*Pi*r)/lam])/(4*Sqrt[I*epsim + epsre]))))/(Sqrt[I*epsim + epsre]*BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*HankelH2[-1 + n, (2*Pi*r)/lam] - BesselJ[-1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*HankelH2[n, (2*Pi*r)/lam] - ((-(1/Sqrt[I*epsim + epsre]) + Sqrt[I*epsim + epsre])*lam*n*BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*HankelH2[n, (2*Pi*r)/lam])/(2*Pi*r))^2;
dq_te_deps_im_n = ((1 + 2*conjc[(BesselJ[-1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*BesselJ[n, (2*Pi*r)/lam] - Sqrt[I*epsim + epsre]*BesselJ[-1 + n, (2*Pi*r)/lam]*BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam] + ((-(1/Sqrt[I*epsim + epsre]) + Sqrt[I*epsim + epsre])*lam*n*BesselJ[n, (2*Pi*r)/lam]*BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam])/(2*Pi*r))/(Sqrt[I*epsim + epsre]*BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*HankelH2[-1 + n, (2*Pi*r)/lam] - BesselJ[-1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*HankelH2[n, (2*Pi*r)/lam] - ((-(1/Sqrt[I*epsim + epsre]) + Sqrt[I*epsim + epsre])*lam*n*BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*HankelH2[n, (2*Pi*r)/lam])/(2*Pi*r))])*((((I/2)*Pi*r*BesselJ[n, (2*Pi*r)/lam]*(BesselJ[-2 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam] - BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]))/(Sqrt[I*epsim + epsre]*lam) - ((I/2)*BesselJ[-1 + n, (2*Pi*r)/lam]*BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam])/Sqrt[I*epsim + epsre] + (((I/2)/(I*epsim + epsre)^(3/2) + (I/2)/Sqrt[I*epsim + epsre])*lam*n*BesselJ[n, (2*Pi*r)/lam]*BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam])/(2*Pi*r) - ((I/2)*Pi*r*BesselJ[-1 + n, (2*Pi*r)/lam]*(BesselJ[-1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam] - BesselJ[1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]))/lam + ((I/4)*(-(1/Sqrt[I*epsim + epsre]) + Sqrt[I*epsim + epsre])*n*BesselJ[n, (2*Pi*r)/lam]*(BesselJ[-1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam] - BesselJ[1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]))/Sqrt[I*epsim + epsre])*(Sqrt[I*epsim + epsre]*BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*HankelH2[-1 + n, (2*Pi*r)/lam] - BesselJ[-1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*HankelH2[n, (2*Pi*r)/lam] - ((-(1/Sqrt[I*epsim + epsre]) + Sqrt[I*epsim + epsre])*lam*n*BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*HankelH2[n, (2*Pi*r)/lam])/(2*Pi*r)) - (BesselJ[-1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*BesselJ[n, (2*Pi*r)/lam] - Sqrt[I*epsim + epsre]*BesselJ[-1 + n, (2*Pi*r)/lam]*BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam] + ((-(1/Sqrt[I*epsim + epsre]) + Sqrt[I*epsim + epsre])*lam*n*BesselJ[n, (2*Pi*r)/lam]*BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam])/(2*Pi*r))*(((I/2)*BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*HankelH2[-1 + n, (2*Pi*r)/lam])/Sqrt[I*epsim + epsre] + ((I/2)*Pi*r*(BesselJ[-1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam] - BesselJ[1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam])*HankelH2[-1 + n, (2*Pi*r)/lam])/lam - ((I/2)*Pi*r*(BesselJ[-2 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam] - BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam])*HankelH2[n, (2*Pi*r)/lam])/(Sqrt[I*epsim + epsre]*lam) - (((I/2)/(I*epsim + epsre)^(3/2) + (I/2)/Sqrt[I*epsim + epsre])*lam*n*BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*HankelH2[n, (2*Pi*r)/lam])/(2*Pi*r) - ((I/4)*(-(1/Sqrt[I*epsim + epsre]) + Sqrt[I*epsim + epsre])*n*(BesselJ[-1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam] - BesselJ[1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam])*HankelH2[n, (2*Pi*r)/lam])/Sqrt[I*epsim + epsre])))/(Sqrt[I*epsim + epsre]*BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*HankelH2[-1 + n, (2*Pi*r)/lam] - BesselJ[-1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*HankelH2[n, (2*Pi*r)/lam] - ((-(1/Sqrt[I*epsim + epsre]) + Sqrt[I*epsim + epsre])*lam*n*BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*HankelH2[n, (2*Pi*r)/lam])/(2*Pi*r))^2;
dq_te_dr_n = ((1 + 2*conjc[(BesselJ[-1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*BesselJ[n, (2*Pi*r)/lam] - Sqrt[I*epsim + epsre]*BesselJ[-1 + n, (2*Pi*r)/lam]*BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam] + ((-(1/Sqrt[I*epsim + epsre]) + Sqrt[I*epsim + epsre])*lam*n*BesselJ[n, (2*Pi*r)/lam]*BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam])/(2*Pi*r))/(Sqrt[I*epsim + epsre]*BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*HankelH2[-1 + n, (2*Pi*r)/lam] - BesselJ[-1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*HankelH2[n, (2*Pi*r)/lam] - ((-(1/Sqrt[I*epsim + epsre]) + Sqrt[I*epsim + epsre])*lam*n*BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*HankelH2[n, (2*Pi*r)/lam])/(2*Pi*r))])*(((Sqrt[I*epsim + epsre]*Pi*BesselJ[n, (2*Pi*r)/lam]*(BesselJ[-2 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam] - BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]))/lam - (Sqrt[I*epsim + epsre]*Pi*(BesselJ[-2 + n, (2*Pi*r)/lam] - BesselJ[n, (2*Pi*r)/lam])*BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam])/lam - ((-(1/Sqrt[I*epsim + epsre]) + Sqrt[I*epsim + epsre])*lam*n*BesselJ[n, (2*Pi*r)/lam]*BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam])/(2*Pi*r^2) + (Pi*BesselJ[-1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*(BesselJ[-1 + n, (2*Pi*r)/lam] - BesselJ[1 + n, (2*Pi*r)/lam]))/lam + ((-(1/Sqrt[I*epsim + epsre]) + Sqrt[I*epsim + epsre])*n*BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*(BesselJ[-1 + n, (2*Pi*r)/lam] - BesselJ[1 + n, (2*Pi*r)/lam]))/(2*r) - ((I*epsim + epsre)*Pi*BesselJ[-1 + n, (2*Pi*r)/lam]*(BesselJ[-1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam] - BesselJ[1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]))/lam + (Sqrt[I*epsim + epsre]*(-(1/Sqrt[I*epsim + epsre]) + Sqrt[I*epsim + epsre])*n*BesselJ[n, (2*Pi*r)/lam]*(BesselJ[-1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam] - BesselJ[1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]))/(2*r))*(Sqrt[I*epsim + epsre]*BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*HankelH2[-1 + n, (2*Pi*r)/lam] - BesselJ[-1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*HankelH2[n, (2*Pi*r)/lam] - ((-(1/Sqrt[I*epsim + epsre]) + Sqrt[I*epsim + epsre])*lam*n*BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*HankelH2[n, (2*Pi*r)/lam])/(2*Pi*r)) - (BesselJ[-1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*BesselJ[n, (2*Pi*r)/lam] - Sqrt[I*epsim + epsre]*BesselJ[-1 + n, (2*Pi*r)/lam]*BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam] + ((-(1/Sqrt[I*epsim + epsre]) + Sqrt[I*epsim + epsre])*lam*n*BesselJ[n, (2*Pi*r)/lam]*BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam])/(2*Pi*r))*(((I*epsim + epsre)*Pi*(BesselJ[-1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam] - BesselJ[1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam])*HankelH2[-1 + n, (2*Pi*r)/lam])/lam + (Sqrt[I*epsim + epsre]*Pi*BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*(HankelH2[-2 + n, (2*Pi*r)/lam] - HankelH2[n, (2*Pi*r)/lam]))/lam - (Sqrt[I*epsim + epsre]*Pi*(BesselJ[-2 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam] - BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam])*HankelH2[n, (2*Pi*r)/lam])/lam + ((-(1/Sqrt[I*epsim + epsre]) + Sqrt[I*epsim + epsre])*lam*n*BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*HankelH2[n, (2*Pi*r)/lam])/(2*Pi*r^2) - (Sqrt[I*epsim + epsre]*(-(1/Sqrt[I*epsim + epsre]) + Sqrt[I*epsim + epsre])*n*(BesselJ[-1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam] - BesselJ[1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam])*HankelH2[n, (2*Pi*r)/lam])/(2*r) - (Pi*BesselJ[-1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*(HankelH2[-1 + n, (2*Pi*r)/lam] - HankelH2[1 + n, (2*Pi*r)/lam]))/lam - ((-(1/Sqrt[I*epsim + epsre]) + Sqrt[I*epsim + epsre])*n*BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*(HankelH2[-1 + n, (2*Pi*r)/lam] - HankelH2[1 + n, (2*Pi*r)/lam]))/(2*r))))/(Sqrt[I*epsim + epsre]*BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*HankelH2[-1 + n, (2*Pi*r)/lam] - BesselJ[-1 + n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*HankelH2[n, (2*Pi*r)/lam] - ((-(1/Sqrt[I*epsim + epsre]) + Sqrt[I*epsim + epsre])*lam*n*BesselJ[n, (2*Sqrt[I*epsim + epsre]*Pi*r)/lam]*HankelH2[n, (2*Pi*r)/lam])/(2*Pi*r))^2;